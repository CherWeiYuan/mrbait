

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Benchmarking and Hardware Requirements &mdash; mrbait 1.1.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'1.1.2',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Acknowledgements" href="acknowledgements.html" />
    <link rel="prev" title="Output Files" href="output.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> mrbait
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="introduction.html">Introduction</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pipeline.html">Pipeline Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="files.html">Input files</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html">Usage options</a></li>
<li class="toctree-l2"><a class="reference internal" href="output.html">Output Files</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Benchmarking and Hardware Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#runtime-scaling">Runtime scaling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#memory-usage">Memory Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l2"><a class="reference internal" href="references.html">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pipeline.html">Pipeline Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="files.html">Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage options</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Output Files</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Benchmarking and Hardware Requirements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#runtime-scaling">Runtime scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#memory-usage">Memory Usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mrbait</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="introduction.html">Introduction</a> &raquo;</li>
        
      <li>Benchmarking and Hardware Requirements</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/benchmarking.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="benchmarking-and-hardware-requirements">
<span id="benchmarking"></span><h1>Benchmarking and Hardware Requirements<a class="headerlink" href="#benchmarking-and-hardware-requirements" title="Permalink to this headline">¶</a></h1>
<p>Use of an HPC or powerful workstation is not necessary, although could speed things
up. Testing was performed on a 2014 iMac with a 4-core Intel i7 processor and
32GB of memory, although only a small fraction of this memory was needed.</p>
<div class="section" id="runtime-scaling">
<h2>Runtime scaling<a class="headerlink" href="#runtime-scaling" title="Permalink to this headline">¶</a></h2>
<p>With a ddRAD dataset sequencing on HiSeq 2500 paired-end with 150bp reads, including
48 individuals and generating 51,931 alignments, the following command was run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>mrbait -L wtd_run1.loci -T <span class="m">4</span> -c <span class="m">12</span> -l <span class="m">150</span> -b <span class="m">60</span> -K 1.0 -d <span class="m">200</span> -F <span class="nv">snp</span><span class="o">=</span>1,10 -s <span class="nv">tile</span><span class="o">=</span>30
</pre></div>
</div>
<p>A total of 46,219 alignments passed filtering, of which 44,808 included a
conserved region long enough for target design. 27,102 targets passed filtering
(which was performed based on number of flanking SNPs) and were used to design
43,342 baits.  Total runtime across 4 threads was 392 seconds.</p>
<p>Parallel processing is implemented where practical, primarily in steps
1 and 2. For step 1 (alignment parsing), it splits alignment files into groups,
to be parsed by each daughter process. During parsing, when an entry must be added
to the SQLite database, this cannot be performed in parallel, so a database lock
is implemented so that commits to the database are queued. However, the decrease
in runtime due to parallelization far outweighs this:</p>
<img alt="_images/runtime.png" src="_images/runtime.png" />
<p>Figure 3: Runtime scaling for Step 1 (most time-intensive step) with varying number of threads</p>
<p>The relationship of runtime to number of threads is similar for step 2 (target discovery),
as is the general scheme of preventing database conflicts caused by concurrent database
updates. These steps (1 and 2) are by far the most time consuming, although pairwise
alignment or BLAST searching in steps 3 or 5 can take considerable time depending on
dataset size.</p>
<p>Runtime (in seconds) and peak memory usage (total) for varying numbers of threads, with a ~50k loci RADseq dataset.:</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="14%" />
<col width="16%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Threads</td>
<td>Step 1(s)</td>
<td>Step 2(s)</td>
<td>Step 3(s)</td>
<td>Step 4(s)</td>
<td>Step 5(s)</td>
<td>Total (s)</td>
<td>Peak mem (MB)</td>
<td>Step 1 mem (MB)</td>
</tr>
<tr class="row-even"><td>1</td>
<td>1182</td>
<td>129</td>
<td>1</td>
<td>25</td>
<td>3</td>
<td>1342</td>
<td>120</td>
<td>80</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>591</td>
<td>69</td>
<td>1</td>
<td>25</td>
<td>3</td>
<td>690</td>
<td>260</td>
<td>100</td>
</tr>
<tr class="row-even"><td>3</td>
<td>399</td>
<td>49</td>
<td>1</td>
<td>25</td>
<td>3</td>
<td>478</td>
<td>275</td>
<td>110</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>320</td>
<td>41</td>
<td>1</td>
<td>25</td>
<td>3</td>
<td>392</td>
<td>300</td>
<td>125</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="memory-usage">
<h2>Memory Usage<a class="headerlink" href="#memory-usage" title="Permalink to this headline">¶</a></h2>
<p>Large alignments are processed piecemeal, with only a single alignment loaded at a time,
thus even large files can be processed without excessive memory requirements. The internal
data structure of mrbait relies on a file-based database (SQLite), making it very efficient
in terms of memory usage. Because of this, it should run on any normal (and reasonably
modern) desktop computer.  Peak memory usage tends to be during step 2 (target discovery),
as at this step all consensus loci are scattered across threads- note that this also
means a slight increase in peak memory requirements as number of threads increases. See
Figure 4 for an example of how memory scales throughout the pipeline steps.</p>
<img alt="_images/mem.png" src="_images/mem.png" />
<p>Figure 4: Memory usage throughout the pipeline (recorded for a 50k loci RADseq dataset).
Total memory usage (black) shows a peak of ~300Mb during step 2. Per-thread memory usage (blue)
cumulatively impacts total memory usage but drops to zero after step 2, as following steps do
not utilize parallel computation</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="acknowledgements.html" class="btn btn-neutral float-right" title="Acknowledgements" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="output.html" class="btn btn-neutral float-left" title="Output Files" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Tyler K. Chafin

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>